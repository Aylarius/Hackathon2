{% extends 'base.html.twig' %}
{% block header %}
    <header>
        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container-fluid" id="container-nav">
                <ul class="nav navbar-nav center-block">
                    <li><a href="{{ path('upload') }}"><i class="fa fa-upload"></i></a></li>
                    <li><a href="{{ path('homepage') }}">
                            <h1>Movember</h1>
                            <img src="{{ asset('bundles/mov/img/mustache.png') }}" alt="" width="70px" />
                        </a>
                    </li>
                    <li><a href="{{ path('homepage') }}"><i class="fa fa-th"></i></a></li>
                </ul>
            </div><!-- /.container-fluid -->
        </nav>
    </header>
{% endblock %}
{% block body %}

    <br><br>


    <section>
        <h2>Voir les moustaches à proximité</h2>
        <div class="row">
            <div class="col-xs-12">
                <div id="map"></div>
            </div>
        </div>
    </section>
    <br><br>
    {% for photo in photos %}
        <div class="col-xs-3">
            <a data-toggle="modal" data-target="{{ '#' ~ photo.id }}">
                    <img src="{{ vich_uploader_asset(photo, 'image', 'MovBundle\\Entity\\Photos') }}" width="100%">
            </a>
        </div>
        <div class="modal fade" id="{{ photo.id }}" tabindex="-1" role="dialog" aria-labelledby="photomodal">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">x</span></button>
                    <div class="modal-body center-block">
                        <img src="{{ vich_uploader_asset(photo, 'image', 'MovBundle\\Entity\\Photos') }}" width="100%" >
                        <br>
                        <div class="ratings"></div>
                        <br>
                        {{ photo.adresse }}
                        {{ photo.lat }}
                        {{ photo.lgt }}
                        <ul class="social-buttons cf">
                            <li>
                                <a href="http://twitter.com/share" class="socialite twitter-share" data-text="Socialite.js" data-url="{{ app.request.getUri }}" data-count="vertical" rel="nofollow" target="_blank"><span class="vhidden">Share on Twitter</span></a>
                            </li>
                            <li>
                                <a href="https://plus.google.com/share?url={{ app.request.getUri }}" class="socialite googleplus-one" data-size="tall" data-href="{{ app.request.getUri }}" rel="nofollow" target="_blank"><span class="vhidden">Share on Google+</span></a>
                            </li>
                            <li>
                                <a href="http://www.facebook.com/sharer.php?u={{ app.request.getUri }}" class="socialite facebook-like" data-href="{{ app.request.getUri }}" data-send="false" data-layout="box_count" data-width="60" data-show-faces="false" rel="nofollow" target="_blank"><span class="vhidden">Share on Facebook</span></a>
                            </li>
                        </ul>
                    </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal -->

    {% endfor %}

{% endblock %}
{% block script %}
    <script src="https://use.fontawesome.com/f0f4368368.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script>
        // Note: This example requires that you consent to location sharing when
        // prompted by your browser. If you see the error "The Geolocation service
        // failed.", it means you probably did not give permission for the browser to
        // locate you.

        function initMap() {
            var map = new google.maps.Map(document.getElementById('map'), {
                center: {lat: -34.397, lng: 150.644},
                zoom: 6
            });
            var infoWindow = new google.maps.InfoWindow({map: map});

            // Try HTML5 geolocation.
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    var pos = {
                        lat: position.coords.latitude,
                        lng: position.coords.longitude
                    };

                    infoWindow.setPosition(pos);
                    infoWindow.setContent('Location found.');
                    map.setCenter(pos);
                }, function() {
                    handleLocationError(true, infoWindow, map.getCenter());
                });
            } else {
                // Browser doesn't support Geolocation
                handleLocationError(false, infoWindow, map.getCenter());
            }
        }

        function handleLocationError(browserHasGeolocation, infoWindow, pos) {
            infoWindow.setPosition(pos);
            infoWindow.setContent(browserHasGeolocation ?
                    'Error: The Geolocation service failed.' :
                    'Error: Your browser doesn\'t support geolocation.');
        }

    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD1U5cXo-xZ-tC3UWLnfYzXg0wO18RQI8A&signed_in=true&callback=initMap" async defer>
    </script>


{% endblock %}